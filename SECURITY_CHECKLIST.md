# üîê Security Checklist - Production Deployment

**–î–∞—Ç–∞**: 22 –¥–µ–∫–∞–±—Ä—è 2024  
**–ü—Ä–æ–µ–∫—Ç**: TW Auto Executor v1.0.0

---

## ‚úÖ –ö–æ–¥ –∏ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∫–æ–¥–∞
- [x] **No hardcoded secrets**: –í—Å–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ `.env`
- [x] **Type-safe**: –°—Ç—Ä–æ–≥–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç injection
- [x] **Input validation**: 
  - Runtime validation (io-ts)
  - JSON Schema validation (Fastify)
  - Branded types –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- [x] **Functional error handling**: –ù–µ—Ç throw/try-catch
- [x] **No eval/exec**: –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –æ–ø–∞—Å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- [x] **0 —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π** –≤ production –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö
- [x] **–ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏**: Fastify, fp-ts, CCXT (–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ)
- [x] **–ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –≤–µ—Ä—Å–∏–∏**: –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∞–∫—Ç—É–∞–ª—å–Ω—ã

---

## ‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

### 1. Webhook Passphrase
**–¢–µ–∫—É—â–∏–π**: `test123` ‚ö†Ô∏è **–û–ü–ê–°–ù–û –î–õ–Ø PRODUCTION!**

**–î–µ–π—Å—Ç–≤–∏–µ**:
```bash
# –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–∏–ª—å–Ω—ã–π –ø–∞—Ä–æ–ª—å
openssl rand -base64 32

# –ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:
# 7xK9mP2vN4qR8tL3jW6sH1gF5dY0zX9c

# –û–±–Ω–æ–≤–∏—Ç—å –≤ .env –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
nano /path/to/.env
# WEBHOOK_PASSPHRASE=7xK9mP2vN4qR8tL3jW6sH1gF5dY0zX9c

# –û–±–Ω–æ–≤–∏—Ç—å –≤ TradingView webhook
```

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å**: üî¥ **–ö–†–ò–¢–ò–ß–ù–û**  
**–ë–µ–∑ —ç—Ç–æ–≥–æ**: –õ—é–±–æ–π –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –æ—Ä–¥–µ—Ä–∞!

---

### 2. API –ö–ª—é—á–∏ –ë–∏—Ä–∂–∏

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ API –∫–ª—é—á–∞
```
–¢–µ–∫—É—â–∏–µ –∫–ª—é—á–∏ –≤ .env:
BINANCE_API_KEY=n9b39rTbGrh...
BINANCE_SECRET=sEpvYpB8Q2s...
```

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏**:
- [ ] –ö–ª—é—á –∏–º–µ–µ—Ç **—Ç–æ–ª—å–∫–æ** –ø—Ä–∞–≤–∞ –Ω–∞ Trading
- [ ] **–ù–ï–¢** –ø—Ä–∞–≤ –Ω–∞ Withdrawal (—Å–Ω—è—Ç–∏–µ —Å—Ä–µ–¥—Å—Ç–≤)
- [ ] **–ù–ï–¢** –ø—Ä–∞–≤ –Ω–∞ Transfer
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω IP Whitelist —Å IP –≤–∞—à–µ–≥–æ VPS
- [ ] –í–∫–ª—é—á–µ–Ω 2FA –Ω–∞ –∞–∫–∫–∞—É–Ω—Ç–µ –±–∏—Ä–∂–∏
- [ ] –ö–ª—é—á –Ω–µ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω (–Ω–µ –ø—É–±–ª–∏–∫–æ–≤–∞–ª—Å—è)

**–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ Binance**:
1. API Management ‚Üí –ù–∞–π—Ç–∏ –∫–ª—é—á
2. Permissions: 
   - ‚úÖ Enable Spot & Margin Trading
   - ‚ùå Enable Withdrawals (–û–¢–ö–õ–Æ–ß–ò–¢–¨!)
   - ‚ùå Enable Transfers (–û–¢–ö–õ–Æ–ß–ò–¢–¨!)
3. IP Access Restriction: 
   - ‚úÖ Restrict access to trusted IPs only
   - –î–æ–±–∞–≤–∏—Ç—å IP –≤–∞—à–µ–≥–æ VPS

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å**: üî¥ **–ö–†–ò–¢–ò–ß–ù–û**  
**–ë–µ–∑ —ç—Ç–æ–≥–æ**: –†–∏—Å–∫ –ø–æ—Ç–µ—Ä–∏ –≤—Å–µ—Ö —Å—Ä–µ–¥—Å—Ç–≤!

---

### 3. Node Environment

**–¢–µ–∫—É—â–∏–π**: `NODE_ENV=development`

**–î–µ–π—Å—Ç–≤–∏–µ –¥–ª—è production**:
```bash
# –í .env –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
NODE_ENV=production
```

**–ß—Ç–æ –∏–∑–º–µ–Ω–∏—Ç—Å—è**:
- –õ–æ–≥–∏ —Å—Ç–∞–Ω—É—Ç –º–µ–Ω–µ–µ –ø–æ–¥—Ä–æ–±–Ω—ã–º–∏ (–±–µ–∑ pino-pretty)
- –û—Ç–∫–ª—é—á–∞—Ç—Å—è dev-only —Ñ—É–Ω–∫—Ü–∏–∏
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å**: üü° **–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø**

---

## üõ°Ô∏è –°–µ—Ç–µ–≤–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### Firewall (UFW)
```bash
# –ë–∞–∑–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
sudo ufw default deny incoming
sudo ufw default allow outgoing
sudo ufw allow 22/tcp   # SSH
sudo ufw allow 3000/tcp # Application (–∏–ª–∏ 443 –µ—Å–ª–∏ —á–µ—Ä–µ–∑ Nginx)
sudo ufw enable
sudo ufw status
```

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å**: üî¥ **–ö–†–ò–¢–ò–ß–ù–û**

---

### HTTPS (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ Nginx)

#### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ (–±–µ–∑ HTTPS)
```
TradingView ‚Üí http://YOUR_VPS_IP:3000/webhook
```
‚ö†Ô∏è **–ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è**: –¢—Ä–∞—Ñ–∏–∫ –Ω–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω

#### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ Nginx + Let's Encrypt (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Nginx
sudo apt install nginx certbot python3-certbot-nginx

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ–º–µ–Ω–∞
sudo nano /etc/nginx/sites-available/tw-executor

# –°–æ–¥–µ—Ä–∂–∏–º–æ–µ:
server {
    listen 80;
    server_name your-domain.com;

    location / {
        proxy_pass http://127.0.0.1:3000;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}

# –í–∫–ª—é—á–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥
sudo ln -s /etc/nginx/sites-available/tw-executor /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx

# –ü–æ–ª—É—á–∏—Ç—å HTTPS —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
sudo certbot --nginx -d your-domain.com

# –í TradingView –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
# https://your-domain.com/webhook
```

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å**: üü° **–ù–ê–°–¢–û–Ø–¢–ï–õ–¨–ù–û –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø**

---

### Rate Limiting (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤:

```bash
npm install @fastify/rate-limit
```

```typescript
// –í src/server.ts
import rateLimit from '@fastify/rate-limit';

fastify.register(rateLimit, {
  max: 100,           // 100 –∑–∞–ø—Ä–æ—Å–æ–≤
  timeWindow: '1 minute'
});
```

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å**: üü¢ **–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û**

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –õ–æ–≥–∏
- [x] Structured logging (Pino)
- [x] –õ–æ–≥–∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç —Å–µ–∫—Ä–µ—Ç—ã
- [x] –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤ —á–µ—Ä–µ–∑ PM2

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤**:
```bash
pm2 logs tw-auto-executor --lines 100
```

**–ß—Ç–æ –∏—Å–∫–∞—Ç—å**:
- ‚ùå API keys –≤ –ª–æ–≥–∞—Ö
- ‚ùå Secrets/passwords
- ‚ùå –ß—Ä–µ–∑–º–µ—Ä–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ PII

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å**: üü° **–í–ê–ñ–ù–û**

---

### Alerts (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**PM2 Plus** (–ø–ª–∞—Ç–Ω—ã–π, –Ω–æ –ø–æ–ª–µ–∑–Ω—ã–π):
```bash
pm2 link <secret> <public>
```

**–ò–ª–∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–≤–æ–∏ alerts**:
- Email –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞
- Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ—à–∏–±–∫–∞—Ö
- Monitoring uptime (UptimeRobot, Pingdom)

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å**: üü¢ **–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø**

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º

### Pre-flight Checklist

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ .env –Ω–∞—Å—Ç—Ä–æ–µ–Ω
cat .env | grep -E "PASSPHRASE|API_KEY|SECRET"

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ passphrase –ù–ï test123
grep "test123" .env && echo "‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–µ—Å—Ç–æ–≤—ã–π passphrase!"

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å NODE_ENV
grep "NODE_ENV=production" .env && echo "‚úì Production mode" || echo "‚ö†Ô∏è Development mode"

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å firewall
sudo ufw status

# 5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å PM2
pm2 list

# 6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å–µ—Ä–≤–∏—Å –æ—Ç–≤–µ—á–∞–µ—Ç
curl http://localhost:3000/health

# 7. –¢–µ—Å—Ç–æ–≤—ã–π –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ—Ä–¥–µ—Ä (—Å —Ä–µ–∞–ª—å–Ω–æ–π –±–∏—Ä–∂–µ–π)
curl -X POST http://localhost:3000/webhook \
  -H "Content-Type: application/json" \
  -d '{
    "exchange": "binance",
    "symbol": "BTC/USDT",
    "action": "buy",
    "volume": 0.0001,
    "orderType": "market",
    "passphrase": "YOUR_PRODUCTION_PASSPHRASE"
  }'
```

---

## üö® Incident Response Plan

### –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫

#### 1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ
```bash
pm2 stop tw-auto-executor
```

#### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ
```bash
pm2 logs tw-auto-executor --lines 200
```

#### 3. –ï—Å–ª–∏ API –∫–ª—é—á —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω
```bash
# 1. –£–¥–∞–ª–∏—Ç—å –∫–ª—é—á –Ω–∞ –±–∏—Ä–∂–µ –ù–ï–ú–ï–î–õ–ï–ù–ù–û
# 2. –í—ã–≤–µ—Å—Ç–∏ –≤—Å–µ —Å—Ä–µ–¥—Å—Ç–≤–∞
# 3. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∫–ª—é—á —Å –Ω–æ–≤—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏
# 4. –û–±–Ω–æ–≤–∏—Ç—å .env
# 5. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å
```

#### 4. –ï—Å–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ä–¥–µ—Ä–∞
```bash
# 1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å
pm2 stop tw-auto-executor

# 2. –ó–∞–∫—Ä—ã—Ç—å –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ–∑–∏—Ü–∏–∏ –≤—Ä—É—á–Ω—É—é –Ω–∞ –±–∏—Ä–∂–µ
# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
# 4. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É
# 5. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ Testnet
# 6. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
```

---

## üìù –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- Type-safe –∫–æ–¥
- Input validation (runtime + schema)
- No hardcoded secrets
- Structured logging
- Functional error handling
- 0 —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö

### üî¥ –ö–†–ò–¢–ò–ß–ù–û - –¢—Ä–µ–±—É–µ—Ç –¥–µ–π—Å—Ç–≤–∏–π
1. **–°–º–µ–Ω–∏—Ç—å passphrase** —Å `test123` –Ω–∞ —Å–∏–ª—å–Ω—ã–π
2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ API –∫–ª—é—á–µ–π** (–±–µ–∑ Withdrawal!)
3. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å IP Whitelist** –Ω–∞ –±–∏—Ä–∂–µ
4. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å firewall** –Ω–∞ VPS

### üü° –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø
1. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å HTTPS —á–µ—Ä–µ–∑ Nginx
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å NODE_ENV=production
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥/alerts
4. –†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ª–æ–≥–∏

### üü¢ –û–ü–¶–ò–û–ù–ê–õ–¨–ù–û
1. Rate limiting
2. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏
3. –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –≤—Ç–æ—Ä–æ–π VPS
4. Advanced –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

---

## üéØ Security Score

**–¢–µ–∫—É—â–∏–π**: 7/10 ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ‚òÜ‚òÜ

**–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø—É–Ω–∫—Ç–æ–≤**: 9/10 ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ

**–ò–¥–µ–∞–ª—å–Ω–æ (—Å HTTPS –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º)**: 10/10 ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê

---

**‚ö†Ô∏è –ù–ï –ó–ê–ü–£–°–ö–ê–ô–¢–ï –í PRODUCTION –ë–ï–ó –í–´–ü–û–õ–ù–ï–ù–ò–Ø –ö–†–ò–¢–ò–ß–ù–´–• –ü–£–ù–ö–¢–û–í!**

_–°–æ–∑–¥–∞–Ω–æ: 22 –¥–µ–∫–∞–±—Ä—è 2024_  
_–í–µ—Ä—Å–∏—è: 1.0.0_

