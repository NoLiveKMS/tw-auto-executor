# –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ: TW Auto Executor

## 1. –û–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

**TW Auto Executor** - –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ –æ—Ç TradingView –Ω–∞ –∫—Ä–∏–ø—Ç–æ–±–∏—Ä–∂–∞—Ö —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π.

### 1.1 –¶–µ–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞

- ‚ö° –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø–æ–ª—É—á–µ–Ω–∏–µ–º —Å–∏–≥–Ω–∞–ª–∞ –∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ–º –æ—Ä–¥–µ—Ä–∞ (< 500ms)
- üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ API –∫–ª—é—á–µ–π
- üìä –°—Ç—Ä–æ–≥–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –æ—à–∏–±–æ–∫
- üí¨ –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö
- üåç –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –±–∏—Ä–∂

### 1.2 –û–±–ª–∞—Å—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è

- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –∏–∑ TradingView
- High-frequency trading –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
- –ê–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–∏–π —Ç—Ä–µ–π–¥–∏–Ω–≥ –¥–ª—è —Ä–æ–∑–Ω–∏—á–Ω—ã—Ö —Ç—Ä–µ–π–¥–µ—Ä–æ–≤

## 2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### 2.1 –í—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ TradingView ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ API Gateway  ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ AWS Lambda  ‚îÇ
‚îÇ   Webhook   ‚îÇ HTTPS ‚îÇ   (AWS)      ‚îÇ Event ‚îÇ  (Node.js)  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                                     ‚îÇ
                       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                       ‚îÇ                             ‚îÇ         ‚îÇ
                       ‚ñº                             ‚ñº         ‚ñº
              ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
              ‚îÇ SSM Parameters ‚îÇ          ‚îÇ    CCXT      ‚îÇ   ‚îÇ Telegram ‚îÇ
              ‚îÇ   (Secrets)    ‚îÇ          ‚îÇ  (Binance,   ‚îÇ   ‚îÇ   Bot    ‚îÇ
              ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò          ‚îÇ   Bybit)     ‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 2.2 –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–æ–¥–∞ (Clean Architecture + FP)

```
src/
‚îú‚îÄ‚îÄ types/                    # Domain Models (—Å—Ç—Ä–æ–≥–∏–µ —Ç–∏–ø—ã)
‚îÇ   ‚îú‚îÄ‚îÄ trade-signal.types.ts # Branded types –¥–ª—è —Å–∏–≥–Ω–∞–ª–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ order.types.ts        # –¢–∏–ø—ã –æ—Ä–¥–µ—Ä–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ error.types.ts        # Union types –æ—à–∏–±–æ–∫
‚îÇ   ‚îî‚îÄ‚îÄ config.types.ts       # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ
‚îú‚îÄ‚îÄ domain/                   # Business Logic (—á–∏—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏)
‚îÇ   ‚îú‚îÄ‚îÄ exchange/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ exchange.service.ts  # CCXT wrapper —Å TaskEither
‚îÇ   ‚îî‚îÄ‚îÄ validation/
‚îÇ       ‚îî‚îÄ‚îÄ signal-validator.ts  # –í–∞–ª–∏–¥–∞—Ü–∏—è —Å Either
‚îÇ
‚îú‚îÄ‚îÄ infrastructure/           # External Services
‚îÇ   ‚îú‚îÄ‚îÄ telegram/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ telegram.service.ts  # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ config/
‚îÇ       ‚îî‚îÄ‚îÄ config.service.ts    # –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îÇ
‚îú‚îÄ‚îÄ application/              # Use Cases
‚îÇ   ‚îî‚îÄ‚îÄ trade-executor.use-case.ts  # –ö–æ–º–ø–æ–∑–∏—Ü–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π
‚îÇ
‚îî‚îÄ‚îÄ handler.ts                # Lambda Entry Point
```

### 2.3 –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –º–æ–Ω–∞–¥—ã –∏–∑ `fp-ts`:

- `Either<E, A>` - —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –æ—à–∏–±–∫–∞–º–∏
- `TaskEither<E, A>` - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –æ—à–∏–±–∫–∞–º–∏
- `pipe()` - –∫–æ–º–ø–æ–∑–∏—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–π

–ü—Ä–∏–º–µ—Ä:

```typescript
pipe(
  validateTradeSignal(rawSignal),         // Either<Error, Signal>
  TE.fromEither,
  TE.chain(exchangeService.createOrder),  // TaskEither<Error, Order>
  TE.map(sendNotification)                // TaskEither<Error, void>
)
```

## 3. –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

### 3.1 Runtime & Language

- **Runtime**: Node.js 20.x LTS
- **–Ø–∑—ã–∫**: TypeScript 5.9
- **–ö–æ–º–ø–∏–ª—è—Ç–æ—Ä**: `tsc` —Å —Å—Ç—Ä–æ–≥–∏–º–∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏

### 3.2 –û—Å–Ω–æ–≤–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

| –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ | –í–µ—Ä—Å–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-----------|--------|-----------|
| `fp-ts` | 2.16.2 | –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ |
| `ccxt` | 4.2.71 | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –±–∏—Ä–∂–∞–º–∏ |
| `axios` | 1.6.5 | HTTP –∫–ª–∏–µ–Ω—Ç –¥–ª—è Telegram |
| `@types/aws-lambda` | 8.10.133 | –¢–∏–ø—ã AWS Lambda |

### 3.3 Dev Dependencies

| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-----------|-----------|
| `eslint` | –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞ |
| `prettier` | –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ |
| `serverless` | –î–µ–ø–ª–æ–π –Ω–∞ AWS |
| `jest` | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ |

### 3.4 AWS Services

- **Lambda**: –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ (Node.js 20.x)
- **API Gateway (HTTP API)**: –ü—Ä–∏–µ–º webhook
- **SSM Parameter Store**: –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤
- **CloudWatch**: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- **IAM**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º

## 4. –î–µ—Ç–∞–ª—å–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –º–æ–¥—É–ª–µ–π

### 4.1 Trade Signal Validator

**–ú–æ–¥—É–ª—å**: `src/domain/validation/signal-validator.ts`

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å**: –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö –æ—Ç TradingView

**–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**:
```typescript
unknown  // –ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π JSON –æ—Ç TradingView
```

**–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**:
```typescript
Either<ValidationError, ValidatedSignal>
```

**–ü—Ä–∞–≤–∏–ª–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏**:

1. `exchange`: –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Å–ø–∏—Å–∫–µ ['binance', 'bybit', 'okx', 'bitget']
2. `symbol`: –§–æ—Ä–º–∞—Ç BASE/QUOTE (–Ω–∞–ø—Ä–∏–º–µ—Ä, BTC/USDT)
3. `action`: 'buy' –∏–ª–∏ 'sell'
4. `orderType`: 'market' –∏–ª–∏ 'limit'
5. `volume`: –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ —á–∏—Å–ª–æ, finite
6. `price`: –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞ –¥–ª—è limit, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ –¥–ª—è market
7. `passphrase`: –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ

**–¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏**:
- Missing required field
- Invalid exchange
- Invalid symbol format
- Negative volume

### 4.2 Exchange Service

**–ú–æ–¥—É–ª—å**: `src/domain/exchange/exchange.service.ts`

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å**: –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ä–¥–µ—Ä–æ–≤ –Ω–∞ –±–∏—Ä–∂–∞—Ö —á–µ—Ä–µ–∑ CCXT

**API**:

```typescript
interface IExchangeService {
  createMarketOrder: (signal: TradeSignal) => TaskEither<DomainError, Order>;
  getBalance: (currency: string) => TaskEither<DomainError, number>;
  fetchOrderStatus: (orderId: string, symbol: Symbol) => TaskEither<DomainError, Order>;
}
```

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**:
- `timeInForce: 'IOC'` –¥–ª—è market –æ—Ä–¥–µ—Ä–æ–≤
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ Exchange –º–µ–∂–¥—É –≤—ã–∑–æ–≤–∞–º–∏ Lambda
- –¢–∞–π–º–∞—É—Ç: 30 —Å–µ–∫—É–Ω–¥

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**:
- `AuthenticationError` ‚Üí 401 (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ API –∫–ª—é—á–∏)
- `InsufficientFunds` ‚Üí 400 (–Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤)
- `NetworkError` ‚Üí 500 (–ø—Ä–æ–±–ª–µ–º—ã —Å–≤—è–∑–∏ —Å –±–∏—Ä–∂–µ–π)
- `ExchangeError` ‚Üí 500 (–æ—à–∏–±–∫–∞ –±–∏—Ä–∂–∏)

### 4.3 Telegram Notification Service

**–ú–æ–¥—É–ª—å**: `src/infrastructure/telegram/telegram.service.ts`

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å**: –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ Telegram

**–§–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏–π**:

**–£—Å–ø–µ—à–Ω—ã–π –æ—Ä–¥–µ—Ä**:
```
üü¢ ORDER EXECUTED

Exchange: BINANCE
Symbol: BTC/USDT
Side: LONG
Amount: 0.001
Price: 50000.00
Status: CLOSED
Latency: 234ms
```

**–û—à–∏–±–∫–∞**:
```
‚ùå ORDER FAILED

Exchange: BINANCE
Symbol: BTC/USDT
Error: InsufficientFunds
Message: Not enough balance
```

**–ü–∞—Ç—Ç–µ—Ä–Ω**: Fire-and-forget (–Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫)

### 4.4 Trade Executor Use Case

**–ú–æ–¥—É–ª—å**: `src/application/trade-executor.use-case.ts`

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å**: –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

**–§–ª–æ—É**:

```
1. validateTradeSignal(rawData)          ‚îÄ‚îÄ‚ñ∂ Either<Error, ValidatedSignal>
   ‚Üì
2. validatePassphrase(signal)            ‚îÄ‚îÄ‚ñ∂ Either<Error, ValidatedSignal>
   ‚Üì
3. exchangeService.createMarketOrder()   ‚îÄ‚îÄ‚ñ∂ TaskEither<Error, Order>
   ‚Üì
4. telegramService.sendNotification()    ‚îÄ‚îÄ‚ñ∂ Fire-and-forget
   ‚Üì
5. Return TradeExecutionResult           ‚îÄ‚îÄ‚ñ∂ TaskEither<Error, Result>
```

**–ú–µ—Ç—Ä–∏–∫–∏**:
- Latency (–º—Å): –í—Ä–µ–º—è –æ—Ç –ø–æ–ª—É—á–µ–Ω–∏—è webhook –¥–æ –æ—Ç–≤–µ—Ç–∞
- Success rate: % —É—Å–ø–µ—à–Ω—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤
- Error types: –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –æ—à–∏–±–æ–∫

### 4.5 Lambda Handler

**–ú–æ–¥—É–ª—å**: `src/handler.ts`

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å**: AWS Lambda entry point

**Endpoints**:

1. **POST /webhook**
   - –ü—Ä–∏–Ω–∏–º–∞–µ—Ç JSON –æ—Ç TradingView
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞—Ç—É—Å –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è

2. **GET /health**
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `{ status: "healthy" }`

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ Cold Start**:
- –ì–ª–æ–±–∞–ª—å–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- Lazy initialization —Å–µ—Ä–≤–∏—Å–æ–≤
- Keep-alive connections

**HTTP Responses**:

| –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|-----|----------|--------|
| 200 | –£—Å–ø–µ—Ö | `{ success: true, orderId: "123" }` |
| 400 | –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ | `{ success: false, error: "ValidationError" }` |
| 500 | –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ | `{ success: false, error: "ExchangeError" }` |

## 5. –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö

### 5.1 TradeSignal (Input)

```typescript
interface TradeSignal {
  readonly exchange: ExchangeId;      // "binance" | "bybit"
  readonly symbol: Symbol;            // "BTC/USDT"
  readonly action: OrderSide;         // "buy" | "sell"
  readonly orderType: OrderType;      // "market" | "limit"
  readonly volume: number;            // 0.001
  readonly price?: number;            // 50000 (optional)
  readonly leverage?: number;         // 10 (optional)
  readonly passphrase?: Passphrase;   // "secret" (optional)
}
```

### 5.2 Order (Output)

```typescript
interface Order {
  readonly id: OrderId;              // "12345678"
  readonly symbol: Symbol;           // "BTC/USDT"
  readonly type: OrderType;          // "market"
  readonly side: OrderSide;          // "buy"
  readonly price?: number;           // 50000
  readonly amount: number;           // 0.001
  readonly filled: number;           // 0.001
  readonly remaining: number;        // 0
  readonly status: OrderStatus;      // "closed"
  readonly timestamp: number;        // 1234567890000
  readonly datetime: string;         // "2024-01-01T00:00:00.000Z"
  readonly fee?: OrderFee;
}
```

### 5.3 DomainError (Errors)

```typescript
type DomainError =
  | ValidationError          // –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
  | ExchangeError           // –û—à–∏–±–∫–∞ –±–∏—Ä–∂–∏
  | AuthenticationError     // –û—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
  | NetworkError            // –°–µ—Ç–µ–≤–∞—è –æ—à–∏–±–∫–∞
  | ConfigurationError      // –û—à–∏–±–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
  | InsufficientFundsError; // –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤
```

## 6. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### 6.1 Environment Variables

–í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ AWS SSM Parameter Store:

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|-----|------------|----------|
| `BINANCE_API_KEY` | SecureString | ‚ùå | API –∫–ª—é—á Binance |
| `BINANCE_API_SECRET` | SecureString | ‚ùå | API —Å–µ–∫—Ä–µ—Ç Binance |
| `BYBIT_API_KEY` | SecureString | ‚ùå | API –∫–ª—é—á Bybit |
| `BYBIT_API_SECRET` | SecureString | ‚ùå | API —Å–µ–∫—Ä–µ—Ç Bybit |
| `TELEGRAM_BOT_TOKEN` | SecureString | ‚ùå | –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞ |
| `TELEGRAM_CHAT_ID` | SecureString | ‚ùå | ID —á–∞—Ç–∞ Telegram |
| `WEBHOOK_PASSPHRASE` | SecureString | ‚ùå | –°–µ–∫—Ä–µ—Ç–Ω–∞—è —Ñ—Ä–∞–∑–∞ |
| `NODE_ENV` | String | ‚úÖ | production/staging/development |
| `LOG_LEVEL` | String | ‚úÖ | debug/info/warn/error |

### 6.2 Lambda Configuration

```yaml
Runtime: nodejs20.x
Memory: 512 MB
Timeout: 30 seconds
Region: ap-northeast-1 (Tokyo)
```

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ Memory**: 512MB - –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —Å–∫–æ—Ä–æ—Å—Ç—å—é –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏ —Å—Ç–æ–∏–º–æ—Å—Ç—å—é.

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ Region**: –¢–æ–∫–∏–æ - –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–æ —Å–µ—Ä–≤–µ—Ä–æ–≤ Binance/Bybit.

## 7. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### 7.1 –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤

- ‚úÖ **SSM Parameter Store** —Å —Ç–∏–ø–æ–º SecureString
- ‚úÖ –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ KMS –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- ‚úÖ –î–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ IAM —Ä–æ–ª—å Lambda
- ‚ùå –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å API –∫–ª—é—á–∏

### 7.2 Webhook Security

**–û–ø—Ü–∏—è 1: Passphrase (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**
- –î–æ–±–∞–≤–∏—Ç—å —Å–µ–∫—Ä–µ—Ç–Ω—É—é —Ñ—Ä–∞–∑—É –≤ JSON
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ
- –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ `openssl rand -base64 32`

**–û–ø—Ü–∏—è 2: IP Whitelist (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ)**
- –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ API Gateway –ø–æ IP TradingView

### 7.3 IAM –ü–æ–ª–∏—Ç–∏–∫–∞

–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ Lambda:

```json
{
  "Effect": "Allow",
  "Action": [
    "ssm:GetParameter",
    "logs:CreateLogStream",
    "logs:PutLogEvents"
  ],
  "Resource": [
    "arn:aws:ssm:*:*:parameter/tw-executor/*",
    "arn:aws:logs:*:*:log-group:/aws/lambda/tw-auto-executor-*"
  ]
}
```

## 8. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### 8.1 CloudWatch Metrics

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è:
- Invocations (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–∑–æ–≤–æ–≤)
- Duration (–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è)
- Errors (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫)
- Throttles (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è)

### 8.2 Custom Logs

–§–æ—Ä–º–∞—Ç –ª–æ–≥–æ–≤:

```
[LEVEL] [TIMESTAMP] Message { context }
```

–ü—Ä–∏–º–µ—Ä—ã:

```
[INFO] [2024-01-01T00:00:00.000Z] üì• Received webhook request { requestId: "abc123" }
[INFO] [2024-01-01T00:00:01.234Z] ‚úÖ Order executed successfully { orderId: "12345", latency: 234 }
[ERROR] [2024-01-01T00:00:02.000Z] ‚ùå Order execution failed { error: "InsufficientFunds" }
```

### 8.3 –ê–ª–µ—Ä—Ç—ã (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å)

- ‚ö†Ô∏è Error rate > 10% –∑–∞ 5 –º–∏–Ω—É—Ç
- ‚ö†Ô∏è Latency > 3 —Å–µ–∫—É–Ω–¥—ã
- ‚ö†Ô∏è Function throttling

## 9. Performance Requirements

### 9.1 Latency Targets

| –ú–µ—Ç—Ä–∏–∫–∞ | Target | Max Acceptable |
|---------|--------|----------------|
| Cold Start | < 1s | < 3s |
| Warm Execution | < 200ms | < 500ms |
| E2E (TradingView ‚Üí Exchange) | < 500ms | < 2s |

### 9.2 Throughput

- **Expected**: 10-100 requests/day
- **Max**: 1000 requests/day (—Å Provisioned Concurrency)

### 9.3 Availability

- **Target**: 99.5% uptime
- **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: AWS Lambda (99.95%), CCXT exchanges

## 10. –°—Ç–æ–∏–º–æ—Å—Ç—å

### 10.1 –†–∞—Å—á—ë—Ç (100 —Å–¥–µ–ª–æ–∫/–¥–µ–Ω—å)

| –°–µ—Ä–≤–∏—Å | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ | –°—Ç–æ–∏–º–æ—Å—Ç—å |
|--------|--------------|-----------|
| Lambda Invocations | 3,000/–º–µ—Å—è—Ü | $0.00 (Free Tier) |
| Lambda Duration | 10 GB-—Å–µ–∫ | $0.17 |
| API Gateway | 3,000 requests | $0.00 |
| SSM Parameters | 7 –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ | $0.00 (Free) |
| CloudWatch Logs | 1 GB | $0.03 |
| **–ò–¢–û–ì–û** | | **~$0.20-0.40/–º–µ—Å—è—Ü** |

### 10.2 –° Provisioned Concurrency

–î–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è —Ö–æ–ª–æ–¥–Ω–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞:

```yaml
provisionedConcurrency: 1
```

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å: **~$10/–º–µ—Å—è—Ü**

## 11. Deployment

### 11.1 CI/CD (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```yaml
# GitHub Actions –ø—Ä–∏–º–µ—Ä
name: Deploy
on:
  push:
    branches: [main]
jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - run: npm install
      - run: npm run build
      - run: serverless deploy
```

### 11.2 Rollback

```bash
# –û—Ç–∫–∞—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏
serverless deploy --stage prod --aws-s3-accelerate
```

## 12. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 12.1 Unit Tests (TODO)

```typescript
describe('validateTradeSignal', () => {
  it('should validate valid signal', () => {
    const signal = { exchange: 'binance', ... };
    const result = validateTradeSignal(signal);
    expect(E.isRight(result)).toBe(true);
  });
});
```

### 12.2 Integration Tests

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å testnet –±–∏—Ä–∂–∏:

```typescript
const testnetConfig: ExchangeConfig = {
  exchangeId: 'binance',
  apiKey: TEST_API_KEY,
  apiSecret: TEST_API_SECRET,
  testnet: true
};
```

## 13. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 13.1 –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- Lambda timeout: 30 —Å–µ–∫—É–Ω–¥
- Payload size: 6 MB
- Concurrent executions: 1000 (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

### 13.2 Known Issues

- Cold start –º–æ–∂–µ—Ç –±—ã—Ç—å > 1s –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ
- CCXT –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É –ø—Ä–∏ loadMarkets()
- Telegram API –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (fire-and-forget —Ä–µ—à–∞–µ—Ç)

## 14. Roadmap

### –§–∞–∑–∞ 1 (MVP) ‚úÖ
- [x] –ë–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- [x] Binance + Bybit –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- [x] Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### –§–∞–∑–∞ 2 (Enhancement)
- [ ] –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ –±–∏—Ä–∂ (OKX, Bitget)
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ stop-loss / take-profit
- [ ] WebSocket –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
- [ ] Dashboard –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

### –§–∞–∑–∞ 3 (Advanced)
- [ ] Machine Learning –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è
- [ ] Multi-region deployment
- [ ] Advanced risk management

---

**–í–µ—Ä—Å–∏—è**: 1.0.0  
**–î–∞—Ç–∞**: 2024-01-01  
**–ê–≤—Ç–æ—Ä**: Maksim

